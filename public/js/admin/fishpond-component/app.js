(()=>{"use strict";const t=function(t){return{id:t.id,name:t.name,label:t.label,placeholder:t.placeholder,type:t.type?t.type:"text",min:t.min,max:t.max,step:t.step,required:t.required,value:t.value?t.value:null,hasError:!1,errorMessage:null,disabled:!1,reset:function(){this.value=null,this.hasError=!1,this.errorMessage=null},setError:function(t){this.hasError=!0,this.errorMessage=t},isOk:function(){this.hasError=!1,this.errorMessage=null}}};const e={originalData:null,title:"Registrar Estanque",inputs:{},name:null,type:null,diameter:null,width:null,long:null,maxHeight:null,effectiveHeight:null,errorInDepth:!1,capacity:null,wire:void 0,dispatch:null,waiting:!1,register:!0,updating:!1,init:function(t,e){this.wire=t,this.dispatch=e,this.__buildInputs()},__buildInputs:function(){this.name=t({id:"fishpondName",name:"name",label:"Nombre",placeholder:"Escribe el nombre del estanque",required:!0}),this.type=t({id:"fishpondType",name:"type",label:"Tipo de estanque",value:"rectangular",required:!0}),this.diameter=t({id:"fishponddiameter",name:"diameter",label:'Diametro del Estanque <span class="text-xs">[m]<span>',placeholder:"Ingresa el diametro del estanque",type:"number",min:.01,max:999.99,step:.01}),this.capacity=t({id:"fishpondCapacity",name:"capacity",label:'Capacidad <span class="text-xs">[und]<span>',type:"number",placeholder:"Ingresa la capacidad del estanque",min:1,max:65535,step:1}),this.width=t({id:"fishpondWidth",name:"width",label:'Ancho <span class="text-xs">[m]<span>',type:"number",placeholder:"ej: 200.45",min:.01,max:999.99,step:.01}),this.long=t({id:"fishpondLong",name:"long",label:'Largo <span class="text-xs">[m]<span>',type:"number",placeholder:"ej: 23.4",min:.01,max:999.99,step:.01}),this.maxHeight=t({id:"fishpondMaxHeight",name:"maxHeight",label:'Maxima <span class="text-xs">[m]<span>',placeholder:"ej: 3.2",type:"number",min:.01,max:9.99,step:.01}),this.effectiveHeight=t({id:"fishpondEffectiveHeight",name:"effectiveHeight",label:'Efectiva <span class="text-xs">[m]<span>',placeholder:"ej: 3",type:"number",min:.01,max:9.99,step:.01}),this.inputs.name=this.name,this.inputs.capacity=this.capacity,this.inputs.type=this.type,this.inputs.diameter=this.diameter,this.inputs.width=this.width,this.inputs.long=this.long,this.inputs.maxHeight=this.maxHeight,this.inputs.effectiveHeight=this.effectiveHeight},submit:function(){this.register?this.storeFishpond():this.updating&&this.updateFishpond()},storeFishpond:function(){var t=this;if(this.validateRegister()){this.disabledInputs(),this.waiting=!0;var e=this.__buildData();this.wire.storeFishpond(e).then((function(e){e.isOk?(t.hidden(),t.enabledInputs(),t.dispatch("new-fishpond-registered",e.data)):t.notifyErrors(e.errors),t.waiting=!1}))}},updateFishpond:function(){var t=this;if(this.validateRegister()){this.disabledInputs(),this.waiting=!0;var e=this.__buildData();this.wire.updateFishpond(this.originalData.id,e).then((function(e){e.isOk?(t.hidden(),t.dispatch("fishpond-updated",e.data)):t.notifyErrors(e.errors),t.waiting=!1,t.enabledInputs()}))}},mountFishpond:function(t){this.resetInputs(),this.originalData=t,this.name.value=t.name,this.capacity.value=t.capacity,this.diameter.value=t.diameter,this.width.value=t.width,this.long.value=t.long,this.maxHeight.value=t.maxHeight,this.effectiveHeight.value=t.effectiveHeight,this.type.value=t.type,this.enabledUpdatingForm()},hidden:function(){this.resetInputs(),this.enabledRegisterForm(),this.errorInDepth=!1,this.dispatch("cancel-register")},resetInputs:function(){for(var t in this.inputs){if(Object.hasOwnProperty.call(this.inputs,t))this.inputs[t].reset()}this.errorInDepth=!1,this.type.value="rectangular"},enabledRegisterForm:function(){this.register=!0,this.updating=!1,this.title="Registrar Estanque"},enabledUpdatingForm:function(){this.register=!1,this.updating=!0,this.title="Actualizar Registro"},disabledInputs:function(){for(var t in this.inputs){if(Object.hasOwnProperty.call(this.inputs,t))this.inputs[t].disabled=!0}},enabledInputs:function(){for(var t in this.inputs){if(Object.hasOwnProperty.call(this.inputs,t))this.inputs[t].disabled=!1}},__buildData:function(){var t=this.name.value,e=this.capacity.value?parseInt(this.capacity.value):null,i=this.type.value,a=null,s=null,n=null,r=this.maxHeight.value?parseFloat(this.maxHeight.value):null,h=this.effectiveHeight.value?parseFloat(this.effectiveHeight.value):null;return"circular"===i?a=this.diameter.value?parseFloat(this.diameter.value):null:"rectangular"===i&&(s=this.width.value?parseFloat(this.width.value):null,n=this.long.value?parseFloat(this.long.value):null),{name:t,capacity:e,type:i,diameter:a,width:s,long:n,max_height:r,effective_height:h}},validateInput:function(t){var e=this.inputs[t];"name"===t?this.validateName():"type"===t?this.validateType():this.validateNumber(e),"maxHeight"!==t&&"effectiveHeight"!==t||this.validateDepth()},validateName:function(){var t=this.name.value;t&&t.length>0?t.length<3?this.name.setError("Nombre demasiado corto"):t.length>20?this.name.setError("El nombre es demasiado largo"):this.name.isOk():this.name.setError("Este campo es requerido.")},validateType:function(){var t=this.type.value;"circular"===t||"rectangular"===t?this.type.isOk():this.type.setError("Tipo de estanque inválido")},validateNumber:function(t){var e=t.value;e?(e=parseFloat(t.value),isNaN(e)?t.setError("valor inválido"):void 0!==t.min&&void 0!==t.max?e>=t.min?e<=t.max?t.isOk():t.setError("Debe ser menor o igual que ".concat(t.max," m")):t.setError("Debe ser mayor o igual que ".concat(t.min,"  m")):void 0!==t.min?e>=t.min?t.isOk():t.setError("Debe ser mayor o igual que ".concat(t.min,"  m")):void 0!==t.max?e<=t.max?t.isOk():t.setError("Debe ser menor o igual que ".concat(t.max," m")):t.isOk()):t.isOk()},validateRegister:function(){var t=!0;for(var e in this.inputs)if(Object.hasOwnProperty.call(this.inputs,e)){var i=this.inputs[e];this.validateInput(e),i.hasError&&(t=!1)}return this.validateDepth(),t&&!this.errorInDepth},validateDepth:function(){var t=this.maxHeight,e=this.effectiveHeight,i=parseFloat(t.value),a=parseFloat(e.value);isNaN(i)||isNaN(a)||i>=a?(t.hasError&&t.errorMessage.length<=0&&t.isOk(),e.hasError&&e.errorMessage.length<=0&&e.isOk(),this.errorInDepth=!1):(t.hasError||t.setError(""),e.hasError||e.setError(""),this.errorInDepth=!0)},notifyErrors:function(t){for(var e in t)if(Object.hasOwnProperty.call(t,e)){var i=t[e];Object.hasOwnProperty.call(this.inputs,e)&&this.inputs[e].setError(i)}}};window.registerForm=function(){return e},window.app=function(){return{showingModal:!1,wire:void 0,dispatch:void 0,fishponds:[],updatingModel:!1,addNewFishpond:function(t){this.fishponds.push(t)},updateFishpond:function(t){var e=this.fishponds.find((function(e){return e.id===t.id}));if(e)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i])},init:function(t,e){this.wire=t,this.dispatch=e,this.updateModel()},editFishpond:function(t){this.showingModal=!0,this.dispatch("edit-fishpond",t)},updateModel:function(){var t=this;this.updatingModel=!0,this.wire.getFishponds().then((function(e){e.forEach((function(e){t.addNewFishpond(e)})),t.updatingModel=!1})).catch((function(e){console.log(e),t.updatingModel=!1}))}}}})();
//# sourceMappingURL=app.js.map